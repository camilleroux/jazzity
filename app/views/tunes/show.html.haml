%article#tune
  %h1= @tune.title

  - if @tune.vehicle
    %p
      %label Vehicle: 
      = @tune.vehicle
  - if @tune.meter
    %p
      %label Meter: 
      = @tune.meter
  - if @tune.concept
    %p
      %label Concept: 
      = @tune.concept
  - if @tune.primary_key
    %p
      %label Key:
      = @tune.primary_key
      = @tune.tonality
      = " (Also #{@tune.secondary_key})" if @tune.secondary_key
  - if @tune.form
    %p
      %label Form:
      = @tune.form
      = "#{@tune.form_length} Bars" if @tune.form_length
      = @tune.form_lengths if @tune.form_lengths
  - if @tune.based_on_progression
    %p
      %label Based on Progression:
      = link_to @tune.based_on_progression, @tune.based_on_progression

  - if @tune.tune_progressions.exists?
    %section#tune-progressions
      %h2 Progressions Used in this Tune:
      %ul
        - @tune.tune_progressions.each do |tune_progression|
          %li
            = link_to tune_progression.progression, tune_progression.progression
            - if tune_progression.comment?
              %p= tune_progression.comment

  - if @tune.tune_concepts.exists?
    %section#tune-concepts
      %h2 Concepts Used in this Tune:
      %ul
        - @tune.tune_concepts.each do |tune_concept|
          %li
            = link_to tune_concept.concept, tune_concept.concept
            - if tune_concept.comment?
              %p= tune_concept.comment


  = render "comments/index", :commentable => @tune


